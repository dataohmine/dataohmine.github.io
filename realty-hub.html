<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RealtyHub Platform - Real Estate Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#059669',
                        secondary: '#047857',
                        accent: '#10B981'
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 font-sans">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-primary rounded-lg flex items-center justify-center mr-3">
                            <i class="fas fa-home text-white text-lg"></i>
                        </div>
                        <span class="text-xl font-semibold text-gray-900">RealtyHub</span>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="mailto:john.mfe@gmail.com" class="text-gray-600 hover:text-primary transition duration-200 hidden sm:inline-flex items-center">
                        <i class="fas fa-envelope mr-2"></i>Contact
                    </a>
                    <a href="index.html" class="text-gray-600 hover:text-primary transition duration-200">← Back to Portfolio</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-4">RealtyHub Platform</h1>
            <p class="text-xl text-gray-600">Complete real estate management with JWT authentication and professional networking</p>
        </div>

        <!-- Demo Login Section -->
        <div class="grid lg:grid-cols-2 gap-8 mb-8">
            <!-- Login Form -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Platform Access</h2>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                    <input 
                        type="email" 
                        id="loginEmail"
                        value="demo@realtyhub.com"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
                    >
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input 
                        type="password" 
                        id="loginPassword"
                        value="demo123"
                        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
                    >
                </div>

                <button onclick="login()" class="w-full bg-primary hover:bg-secondary text-white px-6 py-3 rounded-lg font-semibold transition duration-300 mb-2">
                    <i class="fas fa-sign-in-alt mr-2"></i>Login to Platform
                </button>
                
                <button onclick="testLogin()" class="w-full bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg text-sm transition duration-300">
                    <i class="fas fa-bug mr-2"></i>Test JavaScript
                </button>

                <div class="mt-4 p-3 bg-green-50 rounded-lg">
                    <p class="text-sm text-green-700">
                        <i class="fas fa-info-circle mr-2"></i>
                        Demo credentials are pre-filled. Click login to access the platform.
                    </p>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                <h2 class="text-lg font-semibold text-gray-900 mb-4">Platform Overview</h2>
                
                <div class="grid grid-cols-2 gap-4">
                    <div class="text-center p-4 bg-green-50 rounded-lg">
                        <div class="text-2xl font-bold text-primary">247</div>
                        <div class="text-sm text-gray-600">Active Listings</div>
                    </div>
                    <div class="text-center p-4 bg-blue-50 rounded-lg">
                        <div class="text-2xl font-bold text-blue-600">89</div>
                        <div class="text-sm text-gray-600">Registered Agents</div>
                    </div>
                    <div class="text-center p-4 bg-purple-50 rounded-lg">
                        <div class="text-2xl font-bold text-purple-600">156</div>
                        <div class="text-sm text-gray-600">Active Clients</div>
                    </div>
                    <div class="text-center p-4 bg-orange-50 rounded-lg">
                        <div class="text-2xl font-bold text-orange-600">23</div>
                        <div class="text-sm text-gray-600">Pending Sales</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard Preview -->
        <div id="dashboard" class="hidden">
            <!-- Header -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-8">
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900">AI Listing Generator</h2>
                        <p class="text-gray-600">Upload property photos and generate professional MLS-ready listings in seconds</p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <span class="text-sm text-gray-500">Welcome, Demo User</span>
                        <button onclick="logout()" class="text-sm text-red-600 hover:text-red-700">
                            <i class="fas fa-sign-out-alt mr-1"></i>Logout
                        </button>
                    </div>
                </div>
            </div>

            <!-- Main Listing Generation Interface -->
            <div class="grid lg:grid-cols-3 gap-8">
                <!-- Upload Section -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <h3 class="text-xl font-semibold text-gray-900 mb-6 flex items-center">
                            <i class="fas fa-cloud-upload-alt text-primary mr-3"></i>
                            Photo Upload & Analysis
                        </h3>
                        
                        <div id="mainUploadArea" class="border-2 border-dashed border-gray-300 rounded-lg p-12 text-center hover:border-primary transition-colors cursor-pointer">
                            <div class="max-w-md mx-auto">
                                <i class="fas fa-camera text-6xl text-gray-400 mb-6"></i>
                                <h4 class="text-xl font-semibold text-gray-700 mb-3">Upload Property Photos</h4>
                                <p class="text-gray-500 mb-6">Drop your property photos here or click to select. Our AI will analyze them and generate a professional listing description.</p>
                                
                                <input type="file" id="mainPhotoUpload" multiple accept="image/*" class="hidden" onchange="handleMainPhotoUpload(event)">
                                <button onclick="document.getElementById('mainPhotoUpload').click()" class="bg-primary text-white px-8 py-3 rounded-lg hover:bg-secondary transition font-semibold">
                                    <i class="fas fa-upload mr-2"></i>Select Photos
                                </button>
                                
                                <div class="mt-4 text-sm text-gray-400">
                                    Supports JPG, PNG, HEIC • Max 20 photos • Up to 10MB each
                                </div>
                            </div>
                        </div>
                        
                        <!-- Uploaded Photos Preview -->
                        <div id="mainUploadedPhotos" class="hidden mt-6">
                            <h4 class="font-semibold mb-3">Uploaded Photos</h4>
                            <div id="mainPhotoGrid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4"></div>
                            
                            <div class="mt-6 flex justify-between items-center">
                                <button onclick="clearMainPhotos()" class="text-gray-600 hover:text-gray-800">
                                    <i class="fas fa-trash mr-2"></i>Clear All Photos
                                </button>
                                <button id="mainGenerateBtn" onclick="startMainGeneration()" class="bg-primary text-white px-8 py-3 rounded-lg hover:bg-secondary transition font-semibold">
                                    <i class="fas fa-magic mr-2"></i>Generate Listing
                                </button>
                            </div>
                        </div>
                        
                        <!-- Generation Progress -->
                        <div id="mainGenerationProgress" class="hidden mt-6">
                            <div class="bg-blue-50 rounded-lg p-6">
                                <div class="flex items-center justify-between mb-4">
                                    <h4 class="font-semibold text-blue-900">Generating Your Listing</h4>
                                    <span id="mainProgressPercent" class="text-blue-600 font-medium">0%</span>
                                </div>
                                
                                <div class="bg-blue-200 rounded-full h-3 mb-4">
                                    <div id="mainProgressBar" class="bg-blue-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                                </div>
                                
                                <div id="mainProgressText" class="text-blue-700 text-sm">
                                    Initializing AI analysis...
                                </div>
                                
                                <div class="mt-4 grid grid-cols-2 gap-4 text-sm">
                                    <div id="step1" class="flex items-center text-gray-500">
                                        <i class="fas fa-circle text-xs mr-2"></i>Image Processing
                                    </div>
                                    <div id="step2" class="flex items-center text-gray-500">
                                        <i class="fas fa-circle text-xs mr-2"></i>Feature Detection
                                    </div>
                                    <div id="step3" class="flex items-center text-gray-500">
                                        <i class="fas fa-circle text-xs mr-2"></i>Style Analysis
                                    </div>
                                    <div id="step4" class="flex items-center text-gray-500">
                                        <i class="fas fa-circle text-xs mr-2"></i>Description Generation
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Results & Stats Panel -->
                <div class="space-y-6">
                    <!-- Quick Stats -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <h4 class="font-semibold text-gray-900 mb-4">Today's Activity</h4>
                        <div class="space-y-3">
                            <div class="flex items-center justify-between">
                                <span class="text-gray-600">Listings Generated</span>
                                <span class="font-semibold text-primary">12</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-600">Photos Processed</span>
                                <span class="font-semibold text-blue-600">84</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-600">Time Saved</span>
                                <span class="font-semibold text-green-600">3.2 hours</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Listings -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                        <h4 class="font-semibold text-gray-900 mb-4">Recent Listings</h4>
                        <div class="space-y-3" id="recentListings">
                            <!-- Recent listings will be populated here -->
                            <div class="text-sm text-gray-500 text-center py-4">
                                No listings generated yet. Upload photos to get started!
                            </div>
                        </div>
                    </div>
                    
                    <!-- AI Features -->
                    <div class="bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl border border-blue-200 p-6">
                        <h4 class="font-semibold text-gray-900 mb-3">AI Features</h4>
                        <div class="space-y-2 text-sm">
                            <div class="flex items-center text-gray-700">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                Computer Vision Analysis
                            </div>
                            <div class="flex items-center text-gray-700">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                Smart Room Detection
                            </div>
                            <div class="flex items-center text-gray-700">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                Market-Based Descriptions
                            </div>
                            <div class="flex items-center text-gray-700">
                                <i class="fas fa-check text-green-500 mr-2"></i>
                                MLS Optimization
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Generated Listing Display -->
            <div id="mainGeneratedResult" class="hidden mt-8">
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-semibold text-gray-900">Generated Property Listing</h3>
                        <div class="flex space-x-3">
                            <button onclick="editListing()" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition text-sm">
                                <i class="fas fa-edit mr-2"></i>Edit
                            </button>
                            <button onclick="exportListing()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition text-sm">
                                <i class="fas fa-download mr-2"></i>Export
                            </button>
                            <button onclick="showDistributionModal(generatedProperty)" class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-secondary transition text-sm">
                                <i class="fas fa-share mr-2"></i>Distribute
                            </button>
                        </div>
                    </div>
                    
                    <div id="mainListingContent">
                        <!-- Generated listing content will be displayed here -->
                    </div>
                    
                    <div class="mt-6 flex justify-between">
                        <button onclick="startOver()" class="text-gray-600 hover:text-gray-800">
                            <i class="fas fa-plus mr-2"></i>Generate Another Listing
                        </button>
                    </div>
                </div>
            </div>

            <!-- Professional Network -->
            <div class="grid lg:grid-cols-2 gap-8">
                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Professional Network</h3>
                    <div class="space-y-3">
                        <div class="flex items-center p-3 bg-gray-50 rounded-lg">
                            <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-user text-white"></i>
                            </div>
                            <div class="flex-1">
                                <div class="font-medium text-gray-900">Sarah Johnson</div>
                                <div class="text-sm text-gray-600">Senior Real Estate Agent</div>
                            </div>
                            <button class="text-primary hover:text-secondary">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                        <div class="flex items-center p-3 bg-gray-50 rounded-lg">
                            <div class="w-10 h-10 bg-green-500 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-user text-white"></i>
                            </div>
                            <div class="flex-1">
                                <div class="font-medium text-gray-900">Mike Chen</div>
                                <div class="text-sm text-gray-600">Property Inspector</div>
                            </div>
                            <button class="text-primary hover:text-secondary">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                        <div class="flex items-center p-3 bg-gray-50 rounded-lg">
                            <div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-user text-white"></i>
                            </div>
                            <div class="flex-1">
                                <div class="font-medium text-gray-900">Lisa Rodriguez</div>
                                <div class="text-sm text-gray-600">Mortgage Broker</div>
                            </div>
                            <button class="text-primary hover:text-secondary">
                                <i class="fas fa-comments"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Recent Activity</h3>
                    <div class="space-y-3">
                        <div class="flex items-start space-x-3">
                            <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                            <div class="flex-1">
                                <p class="text-sm text-gray-800">New listing added: 123 Oak Street</p>
                                <p class="text-xs text-gray-500">2 hours ago</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                            <div class="flex-1">
                                <p class="text-sm text-gray-800">Client meeting scheduled with John Smith</p>
                                <p class="text-xs text-gray-500">4 hours ago</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <div class="w-2 h-2 bg-purple-500 rounded-full mt-2"></div>
                            <div class="flex-1">
                                <p class="text-sm text-gray-800">Property sold: 456 Pine Avenue</p>
                                <p class="text-xs text-gray-500">1 day ago</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <div class="w-2 h-2 bg-orange-500 rounded-full mt-2"></div>
                            <div class="flex-1">
                                <p class="text-sm text-gray-800">New client inquiry received</p>
                                <p class="text-xs text-gray-500">2 days ago</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Features Section -->
        <div class="mt-12 grid md:grid-cols-4 gap-6">
            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 text-center">
                <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-shield-alt text-primary text-xl"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">JWT Authentication</h3>
                <p class="text-gray-600 text-sm">Secure login system with token-based authentication and role management.</p>
            </div>

            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 text-center">
                <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-database text-blue-600 text-xl"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">PostgreSQL Backend</h3>
                <p class="text-gray-600 text-sm">Robust database with property listings, user management, and transaction tracking.</p>
            </div>

            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 text-center">
                <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-users text-purple-600 text-xl"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Professional Network</h3>
                <p class="text-gray-600 text-sm">Connect with agents, inspectors, brokers, and other real estate professionals.</p>
            </div>

            <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 text-center">
                <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-chart-bar text-orange-600 text-xl"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Analytics Dashboard</h3>
                <p class="text-gray-600 text-sm">Track property performance, market trends, and business metrics in real-time.</p>
            </div>
        </div>
    </div>

    <script>
        // Enhanced property data with realistic listings
        const sampleProperties = [
            {
                id: 1,
                address: "2847 Mulholland Drive",
                city: "Beverly Hills, CA",
                price: "$3,850,000",
                type: "Luxury Estate",
                beds: 6,
                baths: 5,
                sqft: "4,850",
                yearBuilt: 2019,
                lotSize: "0.82 acres",
                parking: "3-car garage",
                description: "Stunning contemporary estate with panoramic city views. Features include chef's kitchen with marble countertops, infinity pool, home theater, and wine cellar. Premium finishes throughout.",
                status: "For Sale",
                daysOnMarket: 14,
                agent: "Sarah Johnson",
                image: "https://images.unsplash.com/photo-1613977257363-707ba9348227?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                images: [
                    "https://images.unsplash.com/photo-1613977257363-707ba9348227?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1616486338812-3dadae4b4ace?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
                ]
            },
            {
                id: 2,
                address: "1256 Ocean Avenue",
                city: "Santa Monica, CA",
                price: "$2,200,000",
                type: "Modern Condo",
                beds: 3,
                baths: 2.5,
                sqft: "1,950",
                yearBuilt: 2021,
                lotSize: "N/A",
                parking: "2 spaces",
                description: "Oceanfront luxury condo with floor-to-ceiling windows and private balcony. Building amenities include rooftop pool, fitness center, and 24/7 concierge service.",
                status: "For Sale",
                daysOnMarket: 7,
                agent: "Mike Chen",
                image: "https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                images: [
                    "https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
                ]
            },
            {
                id: 3,
                address: "5642 Sunset Boulevard",
                city: "West Hollywood, CA",
                price: "$1,475,000",
                type: "Modern Townhouse",
                beds: 4,
                baths: 3,
                sqft: "2,250",
                yearBuilt: 2020,
                lotSize: "0.15 acres",
                parking: "2-car garage",
                description: "Contemporary townhouse in the heart of West Hollywood. Open-concept design with smart home technology, rooftop terrace, and gourmet kitchen. Walking distance to shopping and dining.",
                status: "For Sale",
                daysOnMarket: 21,
                agent: "Lisa Rodriguez",
                image: "https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                images: [
                    "https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1600607687644-aac4c3eac7f4?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1600566753190-17f0baa2a6c3?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
                ]
            },
            {
                id: 4,
                address: "891 Highland Avenue",
                city: "Pasadena, CA",
                price: "$925,000",
                type: "Craftsman Home",
                beds: 3,
                baths: 2,
                sqft: "1,850",
                yearBuilt: 1925,
                lotSize: "0.25 acres",
                parking: "Detached garage",
                description: "Beautifully restored 1925 Craftsman with original hardwood floors and built-ins. Updated kitchen and bathrooms while maintaining period charm. Large backyard with mature trees.",
                status: "Pending",
                daysOnMarket: 3,
                agent: "David Park",
                image: "https://images.unsplash.com/photo-1518780664697-55e3ad937233?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                images: [
                    "https://images.unsplash.com/photo-1518780664697-55e3ad937233?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1600566753190-17f0baa2a6c3?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
                ]
            },
            {
                id: 5,
                address: "3421 Manhattan Beach Boulevard",
                city: "Manhattan Beach, CA",
                price: "$4,200,000",
                type: "Beachfront Villa",
                beds: 5,
                baths: 4.5,
                sqft: "3,800",
                yearBuilt: 2018,
                lotSize: "0.35 acres",
                parking: "3-car garage + guest parking",
                description: "Spectacular beachfront villa with unobstructed ocean views. Features include elevator, wine cellar, home gym, and direct beach access. Custom design throughout with premium materials.",
                status: "For Sale",
                daysOnMarket: 42,
                agent: "Amanda Torres",
                image: "https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                images: [
                    "https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1600566753086-00f18fb6b3ea?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
                ]
            },
            {
                id: 6,
                address: "789 Arts District Lofts",
                city: "Downtown LA, CA",
                price: "$685,000",
                type: "Industrial Loft",
                beds: 2,
                baths: 2,
                sqft: "1,400",
                yearBuilt: 2017,
                lotSize: "N/A",
                parking: "1 space + storage",
                description: "Converted warehouse loft in trendy Arts District. Exposed brick, concrete floors, and 14-foot ceilings. Modern fixtures, stainless steel appliances, and walk-in closets.",
                status: "For Sale",
                daysOnMarket: 18,
                agent: "Carlos Mendez",
                image: "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                images: [
                    "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1600607687644-aac4c3eac7f4?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1600566753190-17f0baa2a6c3?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
                ]
            },
            {
                id: 7,
                address: "1847 Laurel Canyon Boulevard",
                city: "Hollywood Hills, CA",
                price: "$1,850,000",
                type: "Mid-Century Modern",
                beds: 4,
                baths: 3,
                sqft: "2,650",
                yearBuilt: 1962,
                lotSize: "0.45 acres",
                parking: "2-car carport",
                description: "Iconic mid-century modern home with walls of glass and canyon views. Recently renovated while preserving original Neutra-inspired architecture. Pool, spa, and entertaining deck.",
                status: "For Sale",
                daysOnMarket: 9,
                agent: "Jennifer Lee",
                image: "https://images.unsplash.com/photo-1568605114967-8130f3a36994?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                images: [
                    "https://images.unsplash.com/photo-1568605114967-8130f3a36994?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1600566753086-00f18fb6b3ea?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
                ]
            },
            {
                id: 8,
                address: "2156 Venice Beach Walk",
                city: "Venice, CA",
                price: "$1,350,000",
                type: "Beach House",
                beds: 3,
                baths: 2.5,
                sqft: "1,750",
                yearBuilt: 2019,
                lotSize: "0.12 acres",
                parking: "1-car garage",
                description: "Contemporary beach house steps from the sand. Open floor plan with vaulted ceilings, skylights, and ocean breezes. Rooftop deck with 360-degree views of beach and city.",
                status: "For Sale",
                daysOnMarket: 5,
                agent: "Ryan Mitchell",
                image: "https://images.unsplash.com/photo-1570129477492-45c003edd2be?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                images: [
                    "https://images.unsplash.com/photo-1570129477492-45c003edd2be?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1600566753190-17f0baa2a6c3?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1600607687644-aac4c3eac7f4?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80"
                ]
            }
        ];

        // Login functionality
        function login() {
            console.log('Login function called');
            const email = document.getElementById('loginEmail')?.value;
            const password = document.getElementById('loginPassword')?.value;
            
            console.log('Email:', email, 'Password:', password);

            if (email && password) {
                try {
                    // Simulate JWT token generation
                    const token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkRlbW8gVXNlciIsImlhdCI6MTUxNjIzOTAyMn0.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c';
                    localStorage.setItem('realtyhub_token', token);
                    console.log('Token saved');
                    
                    // Hide login section - try multiple approaches
                    const loginSections = [
                        document.querySelector('div.grid.lg\\:grid-cols-2'),
                        document.querySelector('[class*="grid"][class*="lg:grid-cols-2"]'),
                        document.querySelector('.grid').closest('[class*="lg:grid-cols-2"]'),
                        // Find the parent of the login form
                        document.getElementById('loginEmail')?.closest('.grid')
                    ];
                    
                    let loginSection = null;
                    for (let section of loginSections) {
                        if (section) {
                            loginSection = section;
                            break;
                        }
                    }
                    
                    if (loginSection) {
                        loginSection.style.display = 'none';
                        console.log('Login section hidden');
                    } else {
                        console.error('Could not find login section');
                    }
                    
                    // Show dashboard
                    const dashboard = document.getElementById('dashboard');
                    if (dashboard) {
                        dashboard.classList.remove('hidden');
                        dashboard.style.display = 'block';
                        console.log('Dashboard shown');
                        
                        // Initialize the main interface
                        initializeMainInterface();
                        console.log('Main interface initialized');
                    } else {
                        console.error('Dashboard element not found');
                    }
                    
                } catch (error) {
                    console.error('Login error:', error);
                    alert('Login failed. Please try again.');
                }
            } else {
                alert('Please enter valid credentials');
            }
        }

        // Logout functionality
        function logout() {
            localStorage.removeItem('realtyhub_token');
            location.reload(); // Simple approach: just reload the page
        }
        
        // Test function to verify JavaScript is working
        function testLogin() {
            alert('JavaScript is working! If you can see this alert, click OK and try logging in.');
        }

        // Generate property listings
        function generatePropertyListings() {
            const propertyGrid = document.getElementById('propertyGrid');
            propertyGrid.innerHTML = '';

            sampleProperties.forEach(property => {
                const propertyCard = document.createElement('div');
                propertyCard.className = 'bg-gray-50 rounded-lg overflow-hidden border border-gray-200 hover:shadow-md transition cursor-pointer';
                propertyCard.onclick = () => showPropertyDetails(property);
                
                const statusColor = property.status === 'For Sale' ? 'bg-green-100 text-green-800' : 
                                   property.status === 'Pending' ? 'bg-yellow-100 text-yellow-800' : 
                                   'bg-red-100 text-red-800';
                
                propertyCard.innerHTML = `
                    <div class="relative">
                        <img src="${property.image}" alt="${property.address}" class="w-full h-48 object-cover">
                        <div class="absolute top-2 left-2 ${statusColor} px-2 py-1 rounded-full text-xs font-medium">
                            ${property.status}
                        </div>
                        <div class="absolute top-2 right-2 bg-black bg-opacity-70 text-white px-2 py-1 rounded text-xs">
                            ${property.daysOnMarket} days
                        </div>
                    </div>
                    <div class="p-4">
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="font-semibold text-gray-900 text-sm leading-tight">${property.address}</h4>
                            <span class="text-lg font-bold text-primary">${property.price}</span>
                        </div>
                        <p class="text-sm text-gray-600 mb-2">${property.city}</p>
                        <p class="text-xs text-gray-500 mb-3 line-clamp-2">${property.description}</p>
                        <div class="flex justify-between text-xs text-gray-500 mb-3">
                            <span><i class="fas fa-bed mr-1"></i>${property.beds} beds</span>
                            <span><i class="fas fa-bath mr-1"></i>${property.baths} baths</span>
                            <span><i class="fas fa-ruler-combined mr-1"></i>${property.sqft} sqft</span>
                        </div>
                        <div class="flex justify-between items-center border-t pt-3">
                            <div class="flex items-center">
                                <div class="w-6 h-6 bg-primary rounded-full flex items-center justify-center mr-2">
                                    <i class="fas fa-user text-white text-xs"></i>
                                </div>
                                <span class="text-xs text-gray-600">${property.agent}</span>
                            </div>
                            <span class="text-xs bg-gray-200 text-gray-700 px-2 py-1 rounded-full">${property.type}</span>
                        </div>
                    </div>
                `;
                propertyGrid.appendChild(propertyCard);
            });
        }

        // Show property details modal
        function showPropertyDetails(property) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50';
            modal.onclick = (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            };
            
            const statusColor = property.status === 'For Sale' ? 'text-green-600' : 
                               property.status === 'Pending' ? 'text-yellow-600' : 
                               'text-red-600';
            
            modal.innerHTML = `
                <div class="bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="relative">
                        <img src="${property.image}" alt="${property.address}" class="w-full h-64 object-cover">
                        <button onclick="document.body.removeChild(this.closest('.fixed'))" class="absolute top-4 right-4 bg-black bg-opacity-50 text-white rounded-full w-8 h-8 flex items-center justify-center hover:bg-opacity-70">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="p-6">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h2 class="text-2xl font-bold text-gray-900">${property.address}</h2>
                                <p class="text-gray-600">${property.city}</p>
                            </div>
                            <div class="text-right">
                                <div class="text-2xl font-bold text-primary">${property.price}</div>
                                <div class="${statusColor} font-semibold">${property.status}</div>
                            </div>
                        </div>
                        
                        <div class="grid md:grid-cols-2 gap-6 mb-6">
                            <div>
                                <h3 class="text-lg font-semibold mb-3">Property Details</h3>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Property Type:</span>
                                        <span class="font-medium">${property.type}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Bedrooms:</span>
                                        <span class="font-medium">${property.beds}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Bathrooms:</span>
                                        <span class="font-medium">${property.baths}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Square Feet:</span>
                                        <span class="font-medium">${property.sqft}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Year Built:</span>
                                        <span class="font-medium">${property.yearBuilt}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Lot Size:</span>
                                        <span class="font-medium">${property.lotSize}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Parking:</span>
                                        <span class="font-medium">${property.parking}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h3 class="text-lg font-semibold mb-3">Listing Information</h3>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Days on Market:</span>
                                        <span class="font-medium">${property.daysOnMarket} days</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Listing Agent:</span>
                                        <span class="font-medium">${property.agent}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-600">Price per Sq Ft:</span>
                                        <span class="font-medium">$${Math.round(parseInt(property.price.replace(/[$,]/g, '')) / parseInt(property.sqft.replace(',', '')))}</span>
                                    </div>
                                </div>
                                
                                <div class="mt-4">
                                    <button class="w-full bg-primary text-white py-2 px-4 rounded-lg hover:bg-secondary transition mb-2">
                                        <i class="fas fa-heart mr-2"></i>Save Property
                                    </button>
                                    <button class="w-full border border-primary text-primary py-2 px-4 rounded-lg hover:bg-primary hover:text-white transition">
                                        <i class="fas fa-envelope mr-2"></i>Contact Agent
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold mb-3">Description</h3>
                            <p class="text-gray-700 leading-relaxed">${property.description}</p>
                        </div>
                        
                        ${property.images && property.images.length > 1 ? `
                        <div>
                            <h3 class="text-lg font-semibold mb-3">Additional Photos</h3>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                                ${property.images.slice(1).map(img => `
                                    <img src="${img}" alt="${property.address}" class="w-full h-32 object-cover rounded-lg cursor-pointer hover:opacity-75 transition">
                                `).join('')}
                            </div>
                        </div>
                        ` : ''}
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // Show Add Listing Modal
        function showAddListingModal() {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50';
            modal.onclick = (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            };
            
            modal.innerHTML = `
                <div class="bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-gray-900">Add New Property Listing</h2>
                            <button onclick="document.body.removeChild(this.closest('.fixed'))" class="text-gray-500 hover:text-gray-700">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <div id="uploadStep" class="text-center">
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 mb-6">
                                <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                                <h3 class="text-lg font-semibold text-gray-700 mb-2">Upload Property Photos</h3>
                                <p class="text-gray-500 mb-4">Upload photos and our AI will automatically generate a property listing</p>
                                
                                <input type="file" id="photoUpload" multiple accept="image/*" class="hidden" onchange="handlePhotoUpload(event)">
                                <button onclick="document.getElementById('photoUpload').click()" class="bg-primary text-white px-6 py-3 rounded-lg hover:bg-secondary transition">
                                    <i class="fas fa-upload mr-2"></i>Select Photos
                                </button>
                                
                                <div id="uploadProgress" class="hidden mt-4">
                                    <div class="bg-gray-200 rounded-full h-2 mb-2">
                                        <div id="progressBar" class="bg-primary h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                                    </div>
                                    <p class="text-sm text-gray-600" id="progressText">Processing photos...</p>
                                </div>
                                
                                <div id="uploadedPhotos" class="mt-4 grid grid-cols-3 gap-2"></div>
                            </div>
                            
                            <div class="flex justify-between">
                                <button onclick="document.body.removeChild(this.closest('.fixed'))" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition">
                                    Cancel
                                </button>
                                <button id="generateBtn" onclick="generateListing()" disabled class="px-6 py-2 bg-gray-300 text-gray-500 rounded-lg cursor-not-allowed">
                                    Generate Listing
                                </button>
                            </div>
                        </div>
                        
                        <div id="generatedListing" class="hidden">
                            <h3 class="text-lg font-semibold mb-4">Generated Property Listing</h3>
                            <div id="listingContent" class="space-y-4 mb-6">
                                <!-- Generated content will appear here -->
                            </div>
                            <div class="flex justify-between">
                                <button onclick="resetUpload()" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition">
                                    Upload New Photos
                                </button>
                                <button onclick="saveGeneratedListing()" class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-secondary transition">
                                    Save Listing
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        let uploadedFiles = [];
        let generatedProperty = null;

        // Handle photo upload
        function handlePhotoUpload(event) {
            const files = Array.from(event.target.files);
            uploadedFiles = files;
            
            const uploadedPhotos = document.getElementById('uploadedPhotos');
            const generateBtn = document.getElementById('generateBtn');
            
            uploadedPhotos.innerHTML = '';
            
            files.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('div');
                    img.className = 'relative';
                    img.innerHTML = `
                        <img src="${e.target.result}" alt="Upload ${index + 1}" class="w-full h-20 object-cover rounded border">
                        <div class="absolute top-1 right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs cursor-pointer" onclick="removePhoto(${index})">
                            <i class="fas fa-times"></i>
                        </div>
                    `;
                    uploadedPhotos.appendChild(img);
                };
                reader.readAsDataURL(file);
            });
            
            if (files.length > 0) {
                generateBtn.disabled = false;
                generateBtn.className = 'px-6 py-2 bg-primary text-white rounded-lg hover:bg-secondary transition cursor-pointer';
            }
        }

        // Remove uploaded photo
        function removePhoto(index) {
            uploadedFiles.splice(index, 1);
            handlePhotoUpload({ target: { files: uploadedFiles } });
        }

        // Generate listing from photos with advanced AI processing
        async function generateListing() {
            const progressDiv = document.getElementById('uploadProgress');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            const uploadStep = document.getElementById('uploadStep');
            const generatedDiv = document.getElementById('generatedListing');
            
            progressDiv.classList.remove('hidden');
            
            // Enhanced AI processing pipeline with more detailed steps
            const processingSteps = [
                { progress: 15, text: 'Uploading and preprocessing images...' },
                { progress: 25, text: 'Running computer vision analysis...' },
                { progress: 40, text: 'Identifying rooms and property features...' },
                { progress: 55, text: 'Analyzing architectural style and finishes...' },
                { progress: 70, text: 'Estimating property value using market data...' },
                { progress: 85, text: 'Generating professional listing description...' },
                { progress: 95, text: 'Optimizing for MLS and marketing platforms...' },
                { progress: 100, text: 'Listing generation complete!' }
            ];
            
            let stepIndex = 0;
            const interval = setInterval(() => {
                if (stepIndex < processingSteps.length) {
                    const step = processingSteps[stepIndex];
                    progressBar.style.width = step.progress + '%';
                    progressText.textContent = step.text;
                    stepIndex++;
                } else {
                    clearInterval(interval);
                    setTimeout(async () => {
                        // Generate enhanced property data with AI insights
                        const propertyData = await generateAdvancedProperty();
                        displayGeneratedListing(propertyData);
                        uploadStep.classList.add('hidden');
                        generatedDiv.classList.remove('hidden');
                    }, 800);
                }
            }, 400);
        }

        // Advanced property generation with AI analysis simulation
        async function generateAdvancedProperty() {
            // Simulate computer vision analysis of uploaded photos
            const analysisResults = await analyzeUploadedPhotos();
            
            // Generate property data based on analysis
            const propertyData = {
                id: Date.now(),
                address: generateAddress(),
                city: analysisResults.location,
                price: analysisResults.estimatedPrice,
                type: analysisResults.propertyType,
                beds: analysisResults.bedrooms,
                baths: analysisResults.bathrooms,
                sqft: analysisResults.squareFootage,
                yearBuilt: analysisResults.yearBuilt,
                lotSize: analysisResults.lotSize,
                parking: analysisResults.parking,
                description: generateEnhancedDescription(analysisResults),
                status: 'For Sale',
                daysOnMarket: Math.floor(Math.random() * 60) + 1,
                agent: analysisResults.suggestedAgent,
                image: uploadedFiles.length > 0 ? URL.createObjectURL(uploadedFiles[0]) : 'https://images.unsplash.com/photo-1570129477492-45c003edd2be?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
                images: uploadedFiles.map(file => URL.createObjectURL(file)),
                // Enhanced data
                aiAnalysis: analysisResults.analysis,
                marketInsights: analysisResults.marketData,
                features: analysisResults.features,
                condition: analysisResults.condition,
                pricePerSqft: Math.round(analysisResults.estimatedPrice / analysisResults.squareFootage),
                mlsOptimized: true
            };

            return propertyData;
        }

        // Simulate advanced photo analysis
        async function analyzeUploadedPhotos() {
            // Simulate processing delay for realism
            await new Promise(resolve => setTimeout(resolve, 300));
            
            const propertyTypes = ['Luxury Estate', 'Modern Condo', 'Single Family Home', 'Contemporary Townhouse', 'Craftsman Home', 'Mid-Century Modern', 'Victorian', 'Spanish Colonial'];
            const cities = ['Beverly Hills, CA', 'Santa Monica, CA', 'West Hollywood, CA', 'Pasadena, CA', 'Manhattan Beach, CA', 'Malibu, CA', 'Brentwood, CA', 'Venice, CA'];
            const agents = ['Sarah Johnson', 'Mike Chen', 'Lisa Rodriguez', 'David Park', 'Amanda Torres', 'Jennifer Kim', 'Robert Williams', 'Maria Garcia'];
            
            const propertyType = propertyTypes[Math.floor(Math.random() * propertyTypes.length)];
            const basePrice = getBasePriceByType(propertyType);
            const beds = Math.floor(Math.random() * 4) + 2;
            const baths = beds - 1 + (Math.random() > 0.5 ? 0.5 : 0);
            const sqft = Math.floor(Math.random() * 2500) + 1500;
            
            return {
                propertyType: propertyType,
                location: cities[Math.floor(Math.random() * cities.length)],
                estimatedPrice: basePrice + Math.floor(Math.random() * 1000000),
                bedrooms: beds,
                bathrooms: baths,
                squareFootage: sqft,
                yearBuilt: Math.floor(Math.random() * 40) + 1980,
                lotSize: (Math.random() * 0.8 + 0.15).toFixed(2) + ' acres',
                parking: generateParkingByType(propertyType),
                suggestedAgent: agents[Math.floor(Math.random() * agents.length)],
                analysis: generateAIAnalysis(),
                marketData: generateMarketInsights(),
                features: generatePropertyFeatures(propertyType),
                condition: generateConditionAssessment()
            };
        }

        // Generate base price by property type
        function getBasePriceByType(type) {
            const basePrices = {
                'Luxury Estate': 2500000,
                'Modern Condo': 800000,
                'Single Family Home': 1200000,
                'Contemporary Townhouse': 950000,
                'Craftsman Home': 1100000,
                'Mid-Century Modern': 1400000,
                'Victorian': 1300000,
                'Spanish Colonial': 1350000
            };
            return basePrices[type] || 1000000;
        }

        // Generate parking based on property type
        function generateParkingByType(type) {
            const parkingOptions = {
                'Luxury Estate': ['3-car garage + circular driveway', '4-car garage + guest parking', '2-car garage + carport'],
                'Modern Condo': ['2 assigned spaces', '1 space + storage', 'Valet parking'],
                'Single Family Home': ['2-car garage', 'Attached garage + driveway', '1-car garage + street parking'],
                'Contemporary Townhouse': ['2-car garage', 'Tandem parking', 'Private garage'],
                'Craftsman Home': ['Detached 2-car garage', 'Carport + driveway', 'Street parking + permit'],
                'Mid-Century Modern': ['2-car carport', 'Attached garage', 'Covered parking'],
                'Victorian': ['Converted carriage house', 'Shared driveway', 'Street parking'],
                'Spanish Colonial': ['Courtyard parking', 'Detached garage', 'Covered parking']
            };
            const options = parkingOptions[type] || ['2-car garage', 'Driveway parking', 'Street parking'];
            return options[Math.floor(Math.random() * options.length)];
        }

        // Generate helper functions for advanced property analysis
        function generateAddress() {
            const streetNumbers = Math.floor(Math.random() * 9999) + 1000;
            const streetNames = ['Oak', 'Pine', 'Maple', 'Cedar', 'Elm', 'Willow', 'Canyon', 'Sunset', 'Ocean', 'Mountain'];
            const streetTypes = ['Street', 'Avenue', 'Boulevard', 'Drive', 'Lane', 'Way', 'Place', 'Court'];
            return `${streetNumbers} ${streetNames[Math.floor(Math.random() * streetNames.length)]} ${streetTypes[Math.floor(Math.random() * streetTypes.length)]}`;
        }

        // Generate AI analysis insights
        function generateAIAnalysis() {
            const insights = [
                "Computer vision detected high-end finishes and modern fixtures throughout",
                "Natural light analysis shows excellent exposure with large windows",
                "Kitchen features premium appliances and granite/quartz countertops",
                "Bathrooms show recent renovation with contemporary tile work",
                "Hardwood floors in excellent condition detected in main living areas",
                "Outdoor space includes well-maintained landscaping and entertainment areas",
                "Architecture suggests mid-century modern design with clean lines",
                "Room proportions indicate open-concept living with high ceilings"
            ];
            const randomInsights = [];
            for (let i = 0; i < 3 + Math.floor(Math.random() * 3); i++) {
                const randomInsight = insights[Math.floor(Math.random() * insights.length)];
                if (!randomInsights.includes(randomInsight)) {
                    randomInsights.push(randomInsight);
                }
            }
            return randomInsights;
        }

        // Generate market insights
        function generateMarketInsights() {
            const avgPricePsf = 450 + Math.floor(Math.random() * 350);
            const marketTrend = Math.random() > 0.5 ? 'increasing' : 'stable';
            const competitiveIndex = Math.floor(Math.random() * 100);
            
            return {
                averagePricePerSqft: avgPricePsf,
                marketTrend: marketTrend,
                daysOnMarketAvg: Math.floor(Math.random() * 45) + 15,
                competitiveIndex: competitiveIndex,
                priceRecommendation: marketTrend === 'increasing' ? 'Price aggressively' : 'Price competitively',
                comparableProperties: Math.floor(Math.random() * 15) + 5,
                neighborhoodRating: (Math.random() * 2 + 3).toFixed(1) // 3.0 - 5.0 rating
            };
        }

        // Generate property features based on type
        function generatePropertyFeatures(type) {
            const baseFeatures = ['Updated kitchen', 'Modern bathrooms', 'Central air/heat', 'Hardwood floors'];
            const luxuryFeatures = ['Infinity pool', 'Wine cellar', 'Home theater', 'Smart home system', 'Gourmet kitchen', 'Master suite with sitting area'];
            const condoFeatures = ['Concierge service', 'Rooftop deck', 'Fitness center', 'In-unit laundry', 'Balcony with views'];
            const familyFeatures = ['Large backyard', 'Family room', 'Breakfast nook', 'Walk-in closets', 'Two-car garage'];
            
            let features = [...baseFeatures];
            
            if (type.includes('Luxury') || type.includes('Estate')) {
                features = features.concat(luxuryFeatures.slice(0, 3 + Math.floor(Math.random() * 3)));
            } else if (type.includes('Condo')) {
                features = features.concat(condoFeatures.slice(0, 2 + Math.floor(Math.random() * 3)));
            } else {
                features = features.concat(familyFeatures.slice(0, 2 + Math.floor(Math.random() * 3)));
            }
            
            return features;
        }

        // Generate condition assessment
        function generateConditionAssessment() {
            const conditions = ['Excellent', 'Very Good', 'Good', 'Fair'];
            const condition = conditions[Math.floor(Math.random() * conditions.length)];
            const issues = [];
            
            if (condition === 'Fair') {
                issues.push('Minor cosmetic updates recommended');
            } else if (condition === 'Good') {
                issues.push('Well-maintained with some normal wear');
            }
            
            return {
                overall: condition,
                issues: issues,
                lastUpdated: `${Math.floor(Math.random() * 10) + 1} years ago`,
                score: conditions.indexOf(condition) === 0 ? 95 : 
                       conditions.indexOf(condition) === 1 ? 85 :
                       conditions.indexOf(condition) === 2 ? 75 : 65
            };
        }

        // Enhanced property description generator
        function generateEnhancedDescription(analysisResults) {
            const type = analysisResults.propertyType;
            const features = analysisResults.features.slice(0, 4).join(', ');
            const condition = analysisResults.condition.overall.toLowerCase();
            
            const templates = {
                'Luxury Estate': `Magnificent ${type.toLowerCase()} showcasing ${condition} condition throughout. This stunning property features ${features}, creating an unparalleled living experience. The thoughtfully designed layout maximizes both comfort and sophistication, with premium materials and finishes evident in every detail.`,
                
                'Modern Condo': `Sophisticated ${type.toLowerCase()} in ${condition} condition offers contemporary urban living at its finest. Featuring ${features}, this residence provides both style and convenience. Floor-to-ceiling windows flood the space with natural light while modern amenities ensure comfort and luxury.`,
                
                'Single Family Home': `Beautiful ${type.toLowerCase()} in ${condition} condition, perfect for families seeking comfort and functionality. This well-appointed home includes ${features}, offering the ideal blend of modern updates and timeless appeal. The thoughtful layout creates seamless flow for both daily living and entertaining.`,
                
                'Contemporary Townhouse': `Striking ${type.toLowerCase()} in ${condition} condition combines modern design with practical living. Featuring ${features}, this residence offers the perfect urban lifestyle with suburban comfort. The open-concept design and premium finishes create an impressive living environment.`,
                
                'Craftsman Home': `Charming ${type.toLowerCase()} in ${condition} condition beautifully preserves period character while offering modern conveniences. This distinctive property features ${features}, blending original architectural details with contemporary updates. The timeless design creates warmth and character throughout.`,
                
                'Mid-Century Modern': `Iconic ${type.toLowerCase()} in ${condition} condition exemplifies the best of mid-century design principles. Featuring ${features}, this architectural gem offers clean lines, open spaces, and seamless indoor-outdoor living. The thoughtful renovation respects the original design while adding modern functionality.`,
                
                'Victorian': `Elegant ${type.toLowerCase()} in ${condition} condition showcases the grandeur and craftsmanship of a bygone era. This distinguished property features ${features}, combining original period details with carefully integrated modern amenities. The ornate architecture and rich materials create a truly unique living experience.`,
                
                'Spanish Colonial': `Stunning ${type.toLowerCase()} in ${condition} condition captures the romance and elegance of Spanish colonial architecture. Featuring ${features}, this distinctive residence offers timeless appeal with modern comfort. The authentic details and warm materials create an inviting atmosphere throughout.`
            };
            
            return templates[type] || templates['Single Family Home'].replace('Single Family Home', type);
        }

        // Display enhanced generated listing with AI insights
        function displayGeneratedListing(property) {
            generatedProperty = property;
            const listingContent = document.getElementById('listingContent');
            
            const formatPrice = (price) => {
                if (typeof price === 'string') return price;
                return `$${price.toLocaleString()}`;
            };
            
            listingContent.innerHTML = `
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <img src="${property.image}" alt="${property.address}" class="w-full h-48 object-cover rounded-lg">
                        <div class="mt-2 flex items-center justify-between text-xs text-gray-500">
                            <span><i class="fas fa-robot mr-1"></i>AI Generated</span>
                            <span><i class="fas fa-check-circle text-green-500 mr-1"></i>MLS Ready</span>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <h4 class="text-xl font-bold text-gray-900">${property.address}</h4>
                        <p class="text-gray-600">${property.city}</p>
                        <p class="text-2xl font-bold text-primary">${formatPrice(property.price)}</p>
                        <div class="flex space-x-4 text-sm text-gray-500">
                            <span><i class="fas fa-bed mr-1"></i>${property.beds} beds</span>
                            <span><i class="fas fa-bath mr-1"></i>${property.baths} baths</span>
                            <span><i class="fas fa-ruler-combined mr-1"></i>${property.sqft} sqft</span>
                        </div>
                        <div class="text-sm">
                            <span class="text-gray-600">Price/sq ft:</span> 
                            <span class="font-semibold">$${property.pricePerSqft}</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <div class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium">
                                ${property.condition?.overall || 'Excellent'} Condition
                            </div>
                            <div class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium">
                                ${property.condition?.score || 95} Score
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mb-6">
                    <h5 class="font-semibold mb-3 text-lg flex items-center">
                        <i class="fas fa-file-alt text-primary mr-2"></i>AI-Generated Description
                    </h5>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <p class="text-gray-700 leading-relaxed">${property.description}</p>
                    </div>
                </div>

                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <h5 class="font-semibold mb-3 flex items-center">
                            <i class="fas fa-home text-primary mr-2"></i>Property Details
                        </h5>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Property Type:</span>
                                <span class="font-medium">${property.type}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Year Built:</span>
                                <span class="font-medium">${property.yearBuilt}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Lot Size:</span>
                                <span class="font-medium">${property.lotSize}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Parking:</span>
                                <span class="font-medium">${property.parking}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h5 class="font-semibold mb-3 flex items-center">
                            <i class="fas fa-chart-line text-primary mr-2"></i>Market Analysis
                        </h5>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Market Trend:</span>
                                <span class="font-medium capitalize ${property.marketInsights?.marketTrend === 'increasing' ? 'text-green-600' : 'text-blue-600'}">${property.marketInsights?.marketTrend || 'Stable'}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Area Avg Price/sf:</span>
                                <span class="font-medium">$${property.marketInsights?.averagePricePerSqft || 650}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Avg Days on Market:</span>
                                <span class="font-medium">${property.marketInsights?.daysOnMarketAvg || 30} days</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Comparable Properties:</span>
                                <span class="font-medium">${property.marketInsights?.comparableProperties || 8}</span>
                            </div>
                        </div>
                    </div>
                </div>

                ${property.aiAnalysis && property.aiAnalysis.length > 0 ? `
                <div class="mb-6">
                    <h5 class="font-semibold mb-3 flex items-center">
                        <i class="fas fa-brain text-primary mr-2"></i>AI Photo Analysis
                    </h5>
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <ul class="space-y-1 text-sm text-gray-700">
                            ${property.aiAnalysis.map(insight => `<li class="flex items-start"><i class="fas fa-check text-blue-500 mr-2 mt-0.5 flex-shrink-0"></i>${insight}</li>`).join('')}
                        </ul>
                    </div>
                </div>
                ` : ''}

                ${property.features && property.features.length > 0 ? `
                <div class="mb-6">
                    <h5 class="font-semibold mb-3 flex items-center">
                        <i class="fas fa-star text-primary mr-2"></i>Key Features
                    </h5>
                    <div class="flex flex-wrap gap-2">
                        ${property.features.map(feature => `<span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">${feature}</span>`).join('')}
                    </div>
                </div>
                ` : ''}
            `;
        }

        // Save and distribute generated listing
        function saveGeneratedListing() {
            if (generatedProperty) {
                // Add to local properties
                sampleProperties.unshift(generatedProperty);
                generatePropertyListings();
                
                // Show distribution modal
                showDistributionModal(generatedProperty);
                
                // Close the listing creation modal
                document.body.removeChild(document.querySelector('.fixed'));
            }
        }
        
        // Show property distribution modal
        function showDistributionModal(property) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50';
            modal.onclick = (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            };
            
            modal.innerHTML = `
                <div class="bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-gray-900">Distribute Property Listing</h2>
                            <button onclick="document.body.removeChild(this.closest('.fixed'))" class="text-gray-500 hover:text-gray-700">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                        </div>
                        
                        <div class="bg-green-50 p-4 rounded-lg mb-6">
                            <div class="flex items-center mb-2">
                                <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                <span class="font-semibold text-green-800">Listing Generated Successfully!</span>
                            </div>
                            <p class="text-green-700 text-sm">Your property listing is ready for distribution across multiple platforms.</p>
                        </div>
                        
                        <div class="mb-6">
                            <h3 class="font-semibold mb-3">Property Summary</h3>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <div class="flex items-center space-x-4">
                                    <img src="${property.image}" alt="${property.address}" class="w-16 h-16 object-cover rounded">
                                    <div>
                                        <div class="font-semibold">${property.address}</div>
                                        <div class="text-gray-600">${property.city}</div>
                                        <div class="text-primary font-bold">${formatPrice(property.price)}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <h3 class="font-semibold mb-3">Distribution Platforms</h3>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
                                    <div class="flex items-center">
                                        <input type="checkbox" id="mls" checked class="mr-3 w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary">
                                        <div>
                                            <div class="font-medium">MLS (Multiple Listing Service)</div>
                                            <div class="text-sm text-gray-500">Primary real estate database</div>
                                        </div>
                                    </div>
                                    <div class="text-green-600"><i class="fas fa-check-circle"></i></div>
                                </div>
                                
                                <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
                                    <div class="flex items-center">
                                        <input type="checkbox" id="zillow" checked class="mr-3 w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary">
                                        <div>
                                            <div class="font-medium">Zillow</div>
                                            <div class="text-sm text-gray-500">Leading real estate platform</div>
                                        </div>
                                    </div>
                                    <div class="text-green-600"><i class="fas fa-check-circle"></i></div>
                                </div>
                                
                                <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
                                    <div class="flex items-center">
                                        <input type="checkbox" id="facebook" class="mr-3 w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary">
                                        <div>
                                            <div class="font-medium">Facebook Marketplace</div>
                                            <div class="text-sm text-gray-500">Social media real estate listings</div>
                                        </div>
                                    </div>
                                    <div class="text-gray-400"><i class="fas fa-clock"></i></div>
                                </div>
                                
                                <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
                                    <div class="flex items-center">
                                        <input type="checkbox" id="realtor" class="mr-3 w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary">
                                        <div>
                                            <div class="font-medium">Realtor.com</div>
                                            <div class="text-sm text-gray-500">Official realtor listings platform</div>
                                        </div>
                                    </div>
                                    <div class="text-gray-400"><i class="fas fa-clock"></i></div>
                                </div>
                                
                                <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
                                    <div class="flex items-center">
                                        <input type="checkbox" id="redfin" class="mr-3 w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary">
                                        <div>
                                            <div class="font-medium">Redfin</div>
                                            <div class="text-sm text-gray-500">Modern real estate brokerage</div>
                                        </div>
                                    </div>
                                    <div class="text-gray-400"><i class="fas fa-clock"></i></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 p-4 rounded-lg mb-6">
                            <h4 class="font-semibold mb-2 text-blue-800">Distribution Schedule</h4>
                            <div class="space-y-1 text-sm text-blue-700">
                                <div>• MLS: Immediate (Available now)</div>
                                <div>• Zillow: 15-30 minutes</div>
                                <div>• Other Platforms: 1-2 hours</div>
                            </div>
                        </div>
                        
                        <div class="flex justify-between">
                            <button onclick="document.body.removeChild(this.closest('.fixed'))" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition">
                                Save Only
                            </button>
                            <button onclick="distributeProperty('${property.id}')" class="px-6 py-2 bg-primary text-white rounded-lg hover:bg-secondary transition">
                                <i class="fas fa-share mr-2"></i>Distribute Listing
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        // Format price helper function
        function formatPrice(price) {
            if (typeof price === 'string') return price;
            return `$${price.toLocaleString()}`;
        }
        
        // Distribute property to selected platforms
        function distributeProperty(propertyId) {
            const selectedPlatforms = [];
            const checkboxes = ['mls', 'zillow', 'facebook', 'realtor', 'redfin'];
            
            checkboxes.forEach(platform => {
                const checkbox = document.getElementById(platform);
                if (checkbox && checkbox.checked) {
                    selectedPlatforms.push(platform);
                }
            });
            
            // Close modal
            document.body.removeChild(document.querySelector('.fixed'));
            
            // Show distribution progress
            showDistributionProgress(selectedPlatforms);
        }
        
        // Show distribution progress
        function showDistributionProgress(platforms) {
            const progressModal = document.createElement('div');
            progressModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50';
            
            progressModal.innerHTML = `
                <div class="bg-white rounded-xl max-w-lg w-full p-6">
                    <div class="text-center mb-6">
                        <h3 class="text-xl font-bold text-gray-900">Distributing Property Listing</h3>
                        <p class="text-gray-600">Publishing to ${platforms.length} platform(s)</p>
                    </div>
                    
                    <div id="distributionStatus" class="space-y-3">
                        ${platforms.map(platform => `
                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg" id="${platform}_status">
                                <div class="flex items-center">
                                    <div class="w-6 h-6 border-2 border-primary border-t-transparent rounded-full animate-spin mr-3"></div>
                                    <span class="capitalize">${platform === 'mls' ? 'MLS' : platform}</span>
                                </div>
                                <span class="text-yellow-600">Publishing...</span>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="mt-6 text-center">
                        <div class="text-sm text-gray-500">This may take a few moments...</div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(progressModal);
            
            // Simulate distribution process
            platforms.forEach((platform, index) => {
                setTimeout(() => {
                    const statusElement = document.getElementById(`${platform}_status`);
                    if (statusElement) {
                        statusElement.innerHTML = `
                            <div class="flex items-center">
                                <div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-3">
                                    <i class="fas fa-check text-white text-sm"></i>
                                </div>
                                <span class="capitalize">${platform === 'mls' ? 'MLS' : platform}</span>
                            </div>
                            <span class="text-green-600">Published</span>
                        `;
                    }
                    
                    // Show completion when all platforms are done
                    if (index === platforms.length - 1) {
                        setTimeout(() => {
                            showDistributionSuccess(platforms.length);
                            if (document.body.contains(progressModal)) {
                                document.body.removeChild(progressModal);
                            }
                        }, 1000);
                    }
                }, (index + 1) * 1500);
            });
        }
        
        // Show distribution success message
        function showDistributionSuccess(platformCount) {
            const successDiv = document.createElement('div');
            successDiv.className = 'fixed top-4 right-4 bg-green-500 text-white p-4 rounded-lg shadow-lg z-50 max-w-sm';
            successDiv.innerHTML = `
                <div class="flex items-start">
                    <i class="fas fa-check-circle mr-3 mt-0.5 text-xl"></i>
                    <div>
                        <div class="font-semibold">Distribution Complete!</div>
                        <div class="text-sm opacity-90">Property published to ${platformCount} platform(s)</div>
                    </div>
                </div>
            `;
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                if (document.body.contains(successDiv)) {
                    document.body.removeChild(successDiv);
                }
            }, 4000);
        }

        // Reset upload form
        function resetUpload() {
            uploadedFiles = [];
            generatedProperty = null;
            document.getElementById('uploadStep').classList.remove('hidden');
            document.getElementById('generatedListing').classList.add('hidden');
            document.getElementById('uploadProgress').classList.add('hidden');
            document.getElementById('uploadedPhotos').innerHTML = '';
            document.getElementById('generateBtn').disabled = true;
            document.getElementById('generateBtn').className = 'px-6 py-2 bg-gray-300 text-gray-500 rounded-lg cursor-not-allowed';
        }

        // ===== NEW MAIN INTERFACE FUNCTIONS =====
        
        let mainUploadedFiles = [];
        let mainGeneratedProperty = null;
        let recentListings = [];
        
        // Initialize main interface
        function initializeMainInterface() {
            setupDragAndDrop();
            updateRecentListings();
        }
        
        // Setup drag and drop functionality
        function setupDragAndDrop() {
            const uploadArea = document.getElementById('mainUploadArea');
            
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, preventDefaults, false);
            });
            
            ['dragenter', 'dragover'].forEach(eventName => {
                uploadArea.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, unhighlight, false);
            });
            
            uploadArea.addEventListener('drop', handleDrop, false);
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            function highlight() {
                uploadArea.classList.add('border-primary', 'bg-blue-50');
            }
            
            function unhighlight() {
                uploadArea.classList.remove('border-primary', 'bg-blue-50');
            }
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                handleMainPhotoUpload({ target: { files: files } });
            }
        }
        
        // Handle main photo upload
        function handleMainPhotoUpload(event) {
            const files = Array.from(event.target.files);
            mainUploadedFiles = files;
            
            if (files.length > 0) {
                displayMainUploadedPhotos(files);
                document.getElementById('mainUploadedPhotos').classList.remove('hidden');
                document.getElementById('mainUploadArea').classList.add('hidden');
            }
        }
        
        // Display uploaded photos in main interface
        function displayMainUploadedPhotos(files) {
            const photoGrid = document.getElementById('mainPhotoGrid');
            photoGrid.innerHTML = '';
            
            files.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const photoDiv = document.createElement('div');
                    photoDiv.className = 'relative group';
                    photoDiv.innerHTML = `
                        <img src="${e.target.result}" alt="Upload ${index + 1}" class="w-full h-32 object-cover rounded-lg border">
                        <button onclick="removeMainPhoto(${index})" class="absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity">
                            <i class="fas fa-times"></i>
                        </button>
                        <div class="absolute bottom-2 left-2 bg-black bg-opacity-70 text-white px-2 py-1 rounded text-xs">
                            ${index + 1} of ${files.length}
                        </div>
                    `;
                    photoGrid.appendChild(photoDiv);
                };
                reader.readAsDataURL(file);
            });
        }
        
        // Remove photo from main upload
        function removeMainPhoto(index) {
            mainUploadedFiles.splice(index, 1);
            if (mainUploadedFiles.length > 0) {
                displayMainUploadedPhotos(mainUploadedFiles);
            } else {
                clearMainPhotos();
            }
        }
        
        // Clear all main photos
        function clearMainPhotos() {
            mainUploadedFiles = [];
            document.getElementById('mainUploadedPhotos').classList.add('hidden');
            document.getElementById('mainUploadArea').classList.remove('hidden');
            document.getElementById('mainPhotoUpload').value = '';
        }
        
        // Start main generation process
        async function startMainGeneration() {
            if (mainUploadedFiles.length === 0) {
                alert('Please upload photos first');
                return;
            }
            
            // Hide upload section and show progress
            document.getElementById('mainUploadedPhotos').classList.add('hidden');
            document.getElementById('mainGenerationProgress').classList.remove('hidden');
            
            // Start generation process
            await runMainGenerationProcess();
        }
        
        // Main generation process with enhanced steps
        async function runMainGenerationProcess() {
            const steps = [
                { id: 'step1', text: 'Processing uploaded images...', percent: 25 },
                { id: 'step2', text: 'Detecting rooms and features...', percent: 50 },
                { id: 'step3', text: 'Analyzing architectural style...', percent: 75 },
                { id: 'step4', text: 'Generating description...', percent: 100 }
            ];
            
            const progressBar = document.getElementById('mainProgressBar');
            const progressPercent = document.getElementById('mainProgressPercent');
            const progressText = document.getElementById('mainProgressText');
            
            for (let i = 0; i < steps.length; i++) {
                const step = steps[i];
                
                // Update progress
                progressBar.style.width = step.percent + '%';
                progressPercent.textContent = step.percent + '%';
                progressText.textContent = step.text;
                
                // Update step indicator
                const stepElement = document.getElementById(step.id);
                stepElement.innerHTML = `<i class="fas fa-check text-green-500 text-xs mr-2"></i>${step.text.replace('...', '')}`;
                stepElement.classList.remove('text-gray-500');
                stepElement.classList.add('text-green-600');
                
                // Wait for step completion
                await new Promise(resolve => setTimeout(resolve, 1500));
            }
            
            // Generate the property data
            const propertyData = await generateAdvancedProperty();
            mainGeneratedProperty = propertyData;
            
            // Show results
            setTimeout(() => {
                showMainGenerationResults(propertyData);
            }, 1000);
        }
        
        // Show generation results in main interface
        function showMainGenerationResults(property) {
            // Hide progress
            document.getElementById('mainGenerationProgress').classList.add('hidden');
            
            // Show results
            document.getElementById('mainGeneratedResult').classList.remove('hidden');
            
            // Display the listing content
            const content = document.getElementById('mainListingContent');
            content.innerHTML = generateListingHTML(property);
            
            // Add to recent listings
            addToRecentListings(property);
            
            // Scroll to results
            document.getElementById('mainGeneratedResult').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Generate HTML for listing display
        function generateListingHTML(property) {
            const formatPrice = (price) => {
                if (typeof price === 'string') return price;
                return `$${price.toLocaleString()}`;
            };
            
            return `
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <img src="${property.image}" alt="${property.address}" class="w-full h-64 object-cover rounded-lg">
                        <div class="mt-3 flex items-center justify-between text-sm">
                            <span class="text-gray-500"><i class="fas fa-robot mr-1"></i>AI Generated</span>
                            <span class="text-green-600"><i class="fas fa-check-circle mr-1"></i>MLS Ready</span>
                        </div>
                    </div>
                    <div class="space-y-4">
                        <div>
                            <h4 class="text-2xl font-bold text-gray-900">${property.address}</h4>
                            <p class="text-gray-600">${property.city}</p>
                        </div>
                        <div class="text-3xl font-bold text-primary">${formatPrice(property.price)}</div>
                        <div class="flex space-x-6 text-gray-600">
                            <span><i class="fas fa-bed mr-2"></i>${property.beds} beds</span>
                            <span><i class="fas fa-bath mr-2"></i>${property.baths} baths</span>
                            <span><i class="fas fa-ruler-combined mr-2"></i>${property.sqft} sqft</span>
                        </div>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div><strong>Property Type:</strong> ${property.type}</div>
                            <div><strong>Year Built:</strong> ${property.yearBuilt}</div>
                            <div><strong>Price/sq ft:</strong> $${property.pricePerSqft}</div>
                            <div><strong>Condition:</strong> ${property.condition?.overall || 'Excellent'}</div>
                        </div>
                    </div>
                </div>

                <div class="mb-6">
                    <h5 class="font-semibold mb-3 text-lg">AI-Generated Description</h5>
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <p class="text-gray-800 leading-relaxed text-lg">${property.description}</p>
                    </div>
                </div>

                ${property.aiAnalysis && property.aiAnalysis.length > 0 ? `
                <div class="mb-6">
                    <h5 class="font-semibold mb-3">AI Photo Analysis</h5>
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <ul class="space-y-2 text-sm">
                            ${property.aiAnalysis.map(insight => `<li class="flex items-start"><i class="fas fa-check text-blue-500 mr-2 mt-1"></i>${insight}</li>`).join('')}
                        </ul>
                    </div>
                </div>
                ` : ''}

                ${property.features && property.features.length > 0 ? `
                <div class="mb-6">
                    <h5 class="font-semibold mb-3">Key Features</h5>
                    <div class="flex flex-wrap gap-2">
                        ${property.features.map(feature => `<span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm">${feature}</span>`).join('')}
                    </div>
                </div>
                ` : ''}
            `;
        }
        
        // Add to recent listings
        function addToRecentListings(property) {
            recentListings.unshift(property);
            if (recentListings.length > 5) {
                recentListings = recentListings.slice(0, 5);
            }
            updateRecentListings();
        }
        
        // Update recent listings display
        function updateRecentListings() {
            const container = document.getElementById('recentListings');
            if (recentListings.length === 0) {
                container.innerHTML = `
                    <div class="text-sm text-gray-500 text-center py-4">
                        No listings generated yet. Upload photos to get started!
                    </div>
                `;
                return;
            }
            
            container.innerHTML = recentListings.map(listing => `
                <div class="flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer">
                    <img src="${listing.image}" alt="${listing.address}" class="w-12 h-12 object-cover rounded">
                    <div class="flex-1 min-w-0">
                        <div class="text-sm font-medium text-gray-900 truncate">${listing.address}</div>
                        <div class="text-xs text-gray-500">${listing.city}</div>
                    </div>
                    <div class="text-sm font-semibold text-primary">${typeof listing.price === 'string' ? listing.price : '$' + listing.price.toLocaleString()}</div>
                </div>
            `).join('');
        }
        
        // Start over function
        function startOver() {
            // Reset all states
            document.getElementById('mainGeneratedResult').classList.add('hidden');
            document.getElementById('mainGenerationProgress').classList.add('hidden');
            document.getElementById('mainUploadArea').classList.remove('hidden');
            
            // Clear photos
            clearMainPhotos();
            
            // Reset progress indicators
            const steps = ['step1', 'step2', 'step3', 'step4'];
            steps.forEach(stepId => {
                const stepElement = document.getElementById(stepId);
                stepElement.innerHTML = stepElement.innerHTML.replace('fa-check text-green-500', 'fa-circle').replace('text-green-600', 'text-gray-500');
            });
            
            // Reset progress bar
            document.getElementById('mainProgressBar').style.width = '0%';
            document.getElementById('mainProgressPercent').textContent = '0%';
            
            // Scroll back to top
            document.getElementById('mainUploadArea').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Export listing function
        function exportListing() {
            if (!mainGeneratedProperty) return;
            
            const listingText = `
PROPERTY LISTING - AI GENERATED

Address: ${mainGeneratedProperty.address}
City: ${mainGeneratedProperty.city}
Price: ${typeof mainGeneratedProperty.price === 'string' ? mainGeneratedProperty.price : '$' + mainGeneratedProperty.price.toLocaleString()}
Type: ${mainGeneratedProperty.type}
Bedrooms: ${mainGeneratedProperty.beds}
Bathrooms: ${mainGeneratedProperty.baths}
Square Feet: ${mainGeneratedProperty.sqft}
Year Built: ${mainGeneratedProperty.yearBuilt}

DESCRIPTION:
${mainGeneratedProperty.description}

FEATURES:
${mainGeneratedProperty.features ? mainGeneratedProperty.features.map(f => '• ' + f).join('\n') : 'None specified'}

AI ANALYSIS:
${mainGeneratedProperty.aiAnalysis ? mainGeneratedProperty.aiAnalysis.map(a => '• ' + a).join('\n') : 'None available'}

Generated by RealtyHub AI Listing Generator
            `.trim();
            
            const blob = new Blob([listingText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `listing-${mainGeneratedProperty.address.replace(/\s+/g, '-').toLowerCase()}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }
        
        // Edit listing function
        function editListing() {
            alert('Edit functionality would open a form to modify the generated listing. This is a demo feature.');
        }

        // Check if user is already logged in
        document.addEventListener('DOMContentLoaded', function() {
            const token = localStorage.getItem('realtyhub_token');
            if (token) {
                login();
            }
        });
    </script>
</body>
</html>